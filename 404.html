<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="./vite.svg" />
    <link rel="manifest" href="/manifest.webmanifest" />
    <meta name="theme-color" content="#4f46e5" />
    <link rel="apple-touch-icon" href="/icons/icon-512x512.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>í•´ë³´ì! í–‰ìš´ë¶€ë¥´ê¸°</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Square+Neo:wght@400;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Metrics API base is set by index.tsx via import.meta.env.VITE_METRICS_API_BASE -->
    <style>
      body {
        font-family: 'Nanum Square Neo', sans-serif;
        background-color: #f8fafc; /* Fallback */
        background-image: linear-gradient(to top, #fff1eb 0%, #e0f2fe 100%);
      }
      @keyframes marquee {
        from { transform: translateX(0); }
        to { transform: translateX(-50%); }
      }
      .animate-marquee {
        animation: marquee 40s linear infinite;
      }
    </style>

  <script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.1.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.1.1/",
    "react/": "https://aistudiocdn.com/react@^19.1.1/",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.20.0"
  }
}
</script>
  <script type="module" crossorigin src="/assets/index-rfA9Wo-p.js"></script>
  <link rel="stylesheet" crossorigin href="/assets/index-D0g6LghM.css">
</head>
  <body>
    <div id="root"></div>
  <!-- âœ… PWA ì„¤ì¹˜ ë° Safari ì•ˆë‚´ ë°°ë„ˆ -->
<style>
  #pwaInstallBanner {
    display: none;
    position: static; /* inline bar, not overlay */
    width: 100%;
    background: rgba(30, 30, 30, 0.95);
    color: #fff;
    padding: 12px 16px;
    font-size: 15px;
    text-align: center;
    box-shadow: 0 1px 4px rgba(0,0,0,0.12);
    margin-top: 16px; /* separate from app content */
  }
    /* Compact by default so it never hides the app content */
    #pwaInstallBanner.collapsed {
      display: block;
      padding: 8px 12px;
      font-size: 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    #pwaInstallBanner .actions { display: none; margin-top: 8px; gap: 8px; justify-content: center; flex-wrap: wrap; }
    #pwaInstallBanner.expanded .actions { display: flex; }
    #pwaInstallBanner .summary { display: inline; }
    #pwaInstallBanner.expanded .summary { display: none; }
  #pwaInstallBanner button {
    background: #007aff;
    border: none;
    color: white;
    padding: 8px 14px;
    border-radius: 8px;
    margin-left: 8px;
    font-size: 14px;
  }
    #pwaInstallBanner .secondary { background: #64748b; }
    #pwaInstallBanner .success { background: #34a853; }
</style>

  <!-- Inline guidance bar placed at the bottom of the page flow -->
  <div id="pwaInstallBanner"></div>


<script>
(function() {
  const banner = document.getElementById('pwaInstallBanner');
  const ua = navigator.userAgent;
  const isIOS = /iPhone|iPad|iPod/i.test(ua);
  const isAndroid = /Android/i.test(ua);
  const isInAppBrowser = /(KAKAOTALK|NAVER|FBAN|FBAV|Instagram|Line)/i.test(ua);
  const isKakao = /KAKAOTALK/i.test(ua);
  const isInstagram = /Instagram/i.test(ua);
  const isLine = /Line/i.test(ua);
  const isNaver = /NAVER/i.test(ua);

  // ì´ë¯¸ ì„¤ì¹˜(standalone) ìƒíƒœë©´ ë°°ë„ˆë¥¼ í‘œì‹œí•˜ì§€ ì•ŠìŒ
  const isStandalone = window.matchMedia && window.matchMedia('(display-mode: standalone)').matches;
  if (isStandalone) return;

  // âœ… PWA ì„¤ì¹˜ ì´ë²¤íŠ¸ ê°ì§€ (ì•ˆë“œë¡œì´ë“œ ì „ìš©)
  let deferredPrompt;
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    // iOSê°€ ì•„ë‹ˆë©´ PWA ì„¤ì¹˜ ë°°ë„ˆ í‘œì‹œ
    if (!isIOS && !isInAppBrowser) {
      banner.innerHTML = `
        ğŸ“± ì•±ì²˜ëŸ¼ ì‚¬ìš©í•˜ì‹œê² ì–´ìš”?
        <button id="installBtn">í™ˆí™”ë©´ì— ì¶”ê°€</button>
      `;
      banner.style.display = 'block';

      document.getElementById('installBtn').addEventListener('click', async () => {
        banner.style.display = 'none';
        deferredPrompt.prompt();
        const choice = await deferredPrompt.userChoice;
        if (choice.outcome === 'accepted') {
          console.log('ì‚¬ìš©ìê°€ PWA ì„¤ì¹˜ë¥¼ ìˆ˜ë½í•¨');
        }
      });
    }
  });

  // ì„¤ì¹˜ ì™„ë£Œë˜ë©´ ë°°ë„ˆ ìˆ¨ê¹€
  window.addEventListener('appinstalled', () => {
    banner.style.display = 'none';
    // ì´ ì„¤ì¹˜ìˆ˜ ì¹´ìš´íŠ¸(ì•ˆë“œë¡œì´ë“œ ë“± appinstalled ì§€ì›)
    try { window.MAKE_LUCKY && window.MAKE_LUCKY.hitInstallOnce(); } catch (e) {}
  });

  // âœ… iOS + ì¸ì•±ë¸Œë¼ìš°ì € (ì¹´ì¹´ì˜¤/ì¸ìŠ¤íƒ€/ë¼ì¸/ë„¤ì´ë²„ ë“±)ì¼ ë•Œ: ê°•ì œ Safari ì‹¤í–‰ì€ ë¶ˆê°€ â†’ ì‹¤ìš©ì  ëŒ€ì•ˆ ì œê³µ
  if (isIOS && isInAppBrowser) {
    const currentUrl = window.location.href;

    const copyUrl = async () => {
      try {
        if (navigator.clipboard?.writeText) {
          await navigator.clipboard.writeText(currentUrl);
          alert('ì£¼ì†Œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ í™ˆìœ¼ë¡œ ë‚˜ê°€ Safarië¥¼ ì—´ê³  ì£¼ì†Œì°½ì— ë¶™ì—¬ë„£ê¸° í•´ì£¼ì„¸ìš”.');
        } else {
          // fallback: ì„ì‹œ input ì‚¬ìš©
          const el = document.createElement('input');
          el.value = currentUrl;
          document.body.appendChild(el);
          el.select();
          document.execCommand('copy');
          document.body.removeChild(el);
          alert('ì£¼ì†Œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ í™ˆìœ¼ë¡œ ë‚˜ê°€ Safarië¥¼ ì—´ê³  ì£¼ì†Œì°½ì— ë¶™ì—¬ë„£ê¸° í•´ì£¼ì„¸ìš”.');
        }
      } catch (e) {
        alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì£¼ì†Œë¥¼ ê¸¸ê²Œ ëˆŒëŸ¬ ë³µì‚¬í•˜ê±°ë‚˜, ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ ì£¼ì„¸ìš”.\n' + currentUrl);
      }
    };

    const tryOpenChrome = () => {
      // ì¼ë¶€ ì¸ì•± ë¸Œë¼ìš°ì €ì—ì„œëŠ” ì»¤ìŠ¤í…€ ìŠ¤í‚´ì´ í—ˆìš©ë˜ì–´ SafariëŠ” ë¶ˆê°€í•˜ì§€ë§Œ Chromeìœ¼ë¡œëŠ” ì´ë™ ê°€ëŠ¥í•  ìˆ˜ ìˆìŒ
      const isHttps = currentUrl.startsWith('https://');
      const scheme = isHttps ? 'googlechromes://' : 'googlechrome://';
      const target = scheme + currentUrl.replace(/^https?:\/\//, '');
      // ì—´ê¸° ì‹œë„ (ì‹¤íŒ¨ ì‹œ ì•„ë¬´ ë³€í™” ì—†ìŒ)
      window.location.href = target;
      // 1~2ì´ˆ í›„ì—ë„ ë³€í™” ì—†ìœ¼ë©´ ì•ˆë‚´ ìœ ì§€
      setTimeout(() => {
        // no-op: ì¸ì•±ì—ì„œ ì°¨ë‹¨ë˜ëŠ” ê²½ìš°ê°€ ë§ì•„ ì•ˆë‚´ ë¬¸êµ¬ë¡œ ëŒ€ì²´
      }, 1500);
    };

    // ì•±ë³„ ë” ì •í™•í•œ ì•ˆë‚´ ë¬¸êµ¬
    let appTipMain = 'ì¼ë¶€ ì¸ì•± ë¸Œë¼ìš°ì €ì—ì„œëŠ” â€œê³µìœ í•˜ê¸°(â¬†ï¸)â€ ëŒ€ì‹  ìš°ì¸¡ ìƒë‹¨ì˜ <strong>â‹¯</strong> ë©”ë‰´ì— â€œSafariì—ì„œ ì—´ê¸°/ë¸Œë¼ìš°ì €ë¡œ ì—´ê¸°â€ê°€ ìˆìŠµë‹ˆë‹¤.';
    let appSteps = '';
    if (isKakao) {
      appSteps = 'ì¹´ì¹´ì˜¤í†¡: ìš°ì¸¡ ìƒë‹¨ <strong>â‹¯</strong> â†’ <strong>Safariì—ì„œ ì—´ê¸°</strong> (ë˜ëŠ” ê³µìœ í•˜ê¸° â¬†ï¸ â†’ Safariì—ì„œ ì—´ê¸°).';
    } else if (isInstagram) {
      appSteps = 'ì¸ìŠ¤íƒ€ê·¸ë¨: ìš°ì¸¡ ìƒë‹¨ <strong>â‹¯</strong> â†’ <strong>ë¸Œë¼ìš°ì €ë¡œ ì—´ê¸°</strong>ë¥¼ ì„ íƒí•˜ë©´ iOS ê¸°ë³¸ ë¸Œë¼ìš°ì €ë¡œ ì´ë™í•©ë‹ˆë‹¤.';
    } else if (isLine) {
      appSteps = 'ë¼ì¸: ìš°ì¸¡ ìƒë‹¨ <strong>â‹¯</strong> ë˜ëŠ” ê³µìœ  â¬†ï¸ â†’ <strong>Safariì—ì„œ ì—´ê¸°</strong>ë¥¼ ì„ íƒí•˜ì„¸ìš”.';
    } else if (isNaver) {
      appSteps = 'ë„¤ì´ë²„ì•±: ìš°ì¸¡ í•˜ë‹¨ <strong>â‹¯</strong> â†’ <strong>iOS ê¸°ë³¸ ë¸Œë¼ìš°ì €ë¡œ ì—´ê¸°(Safari)</strong>ë¥¼ ì„ íƒí•˜ì„¸ìš”.';
    }

    banner.innerHTML = `
      <span class="summary">Safari ë˜ëŠ” ê¸°ë³¸ ë¸Œë¼ìš°ì €ì—ì„œ ì—´ë©´ ì„¤ì¹˜ê°€ ì‰¬ì›Œìš”. <button id="expandBannerBtn" class="secondary" style="margin-left:6px;">ìì„¸íˆ</button></span>
      <div class="actions">
        <div style="margin-bottom:6px; font-size:13px; opacity:0.9;">
          <div>${appTipMain}</div>
          ${appSteps ? `<div style=\"margin-top:4px;\">${appSteps}</div>` : ''}
        </div>
        <div style="display:flex; gap:8px; justify-content:center; flex-wrap:wrap;">
          <button id="copyUrlBtn">ì£¼ì†Œ ë³µì‚¬</button>
          <button id="openChromeBtn" class="success">Chromeì—ì„œ ì—´ê¸°</button>
          <button id="closeBannerBtn" class="secondary">ë‹«ê¸°</button>
        </div>
      </div>
    `;
    banner.classList.add('collapsed');
    banner.style.display = 'block';

    const dismiss = () => {
      banner.style.display = 'none';
      try { sessionStorage.setItem('pwaBannerDismissed', '1'); } catch(_){}
    };

    document.getElementById('expandBannerBtn')?.addEventListener('click', () => {
      banner.classList.remove('collapsed');
      banner.classList.add('expanded');
    });
    document.getElementById('copyUrlBtn').addEventListener('click', copyUrl);
    document.getElementById('openChromeBtn').addEventListener('click', tryOpenChrome);
    document.getElementById('closeBannerBtn').addEventListener('click', dismiss);
  }

  // âœ… iOS Safariì—ì„œëŠ” ì„¤ì¹˜ ì•ˆë‚´ (Add to Home Screen)
  if (isIOS && !isInAppBrowser) {
    // show compact summary only; auto-hide quickly so content remains fully visible
    banner.innerHTML = `
      <span class="summary">í™ˆ í™”ë©´ì— ì¶”ê°€í•˜ë ¤ë©´ ê³µìœ (â¬†ï¸) â†’ â€œí™ˆ í™”ë©´ì— ì¶”ê°€â€ë¥¼ ëˆ„ë¥´ì„¸ìš”.</span>
    `;
    try {
      if (sessionStorage.getItem('pwaBannerDismissed') === '1') return;
    } catch(_){}
    banner.classList.add('collapsed');
    banner.style.display = 'block';
    setTimeout(() => {
      banner.style.display = 'none';
      try { sessionStorage.setItem('pwaBannerDismissed', '1'); } catch(_){ }
    }, 6000);
  }

})();
</script>

<!-- âœ… Service Worker ë“±ë¡ (PWA installability ë³´ì¥) -->
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      // ìƒëŒ€ ê²½ë¡œë¡œ ë“±ë¡: /MakeLucky/ ë° ë£¨íŠ¸ ëª¨ë‘ì—ì„œ ì •ìƒ ë™ì‘
      navigator.serviceWorker.register('./sw.js').catch((err) => {
        console.warn('Service Worker registration failed', err);
      });
    });
  }

  // âœ… iOS ë“± appinstalled ì´ë²¤íŠ¸ê°€ ì—†ëŠ” í™˜ê²½: ë…ë¦½ì‹¤í–‰(standalone) ì²« ì‹¤í–‰ ì‹œ ì„¤ì¹˜ìˆ˜ ì¦ê°€
  (function() {
    try {
      const isStandalone = window.matchMedia && window.matchMedia('(display-mode: standalone)').matches;
      if (isStandalone) {
        try { window.MAKE_LUCKY && window.MAKE_LUCKY.hitInstallOnce(); } catch (e) {}
      }
    } catch (e) { /* ignore */ }
  })();
  </script>

  </body>
</html>